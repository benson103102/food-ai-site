<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>æ™ºæ…§é£²é£Ÿè¾¨è­˜ç³»çµ±</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light py-5">

  <div class="container">
    <h1 class="text-center text-primary mb-4">ğŸ± æ™ºæ…§é£²é£Ÿè¾¨è­˜ç³»çµ±</h1>

    <div class="card p-4 shadow">

      <!-- ä¸‹æ‹‰é¸å–®åˆ‡æ›æ¨¡å¼ -->
      <div class="mb-3">
        <label for="mode" class="form-label">é¸æ“‡ä¸Šå‚³æ–¹å¼ï¼š</label>
        <select id="mode" class="form-select" onchange="switchMode()">
          <option value="photo">ğŸ“· æ‹ç…§</option>
          <option value="upload">ğŸ“ ä¸Šå‚³ç›¸ç°¿åœ–ç‰‡</option>
        </select>
      </div>

      <!-- ğŸ“· æ‹ç…§æ¨¡å¼ï¼šå–®å¼µ -->
      <input type="file"
             id="photoInput"
             accept="image/*"
             capture="environment"
             class="form-control mb-3"
             onchange="previewImages(event)"
             style="display: block;">

      <!-- ğŸ“ ä¸Šå‚³æ¨¡å¼ï¼šå¯å¤šå¼µ -->
      <input type="file"
             id="uploadInput"
             accept="image/*"
             multiple
             class="form-control mb-3"
             onchange="previewImages(event)"
             style="display: none;">

      <!-- é è¦½åœ–ç‰‡å€ -->
      <div id="previewArea" class="row g-3 mb-3"></div>

      <!-- æŒ‰éˆ• -->
      <div class="d-flex justify-content-between">
        <button class="btn btn-secondary" onclick="resetUpload()">é‡æ–°ä¸Šå‚³</button>
        <button class="btn btn-success" onclick="uploadAndRecognize()">é€å‡ºè¾¨è­˜</button>
      </div>

      <!-- çµæœ -->
      <div id="result" class="alert alert-info mt-4 d-none"></div>
    </div>
  </div>

  <script>
    let selectedFiles = [];

    // åˆ‡æ›æ¨¡å¼ï¼ˆæ‹ç…§ / ä¸Šå‚³ï¼‰
    function switchMode() {
      const mode = document.getElementById("mode").value;
      const photo = document.getElementById("photoInput");
      const upload = document.getElementById("uploadInput");

      if (mode === "photo") {
        photo.style.display = 'block';
        upload.style.display = 'none';
        selectedFiles = [];
        resetUpload();
      } else {
        photo.style.display = 'none';
        upload.style.display = 'block';
        selectedFiles = [];
        resetUpload();
      }
    }

    // é è¦½åœ–ç‰‡ï¼ˆå–®å¼µæˆ–å¤šå¼µï¼‰
    function previewImages(event) {
      const files = event.target.files;
      selectedFiles = Array.from(files);

      const preview = document.getElementById('previewArea');
      preview.innerHTML = '';

      for (let i = 0; i < selectedFiles.length; i++) {
        const reader = new FileReader();
        reader.onload = function(e) {
          const col = document.createElement('div');
          col.className = 'col-md-4';
          col.innerHTML = `<img src="${e.target.result}" class="img-fluid rounded shadow">`;
          preview.appendChild(col);
        };
        reader.readAsDataURL(selectedFiles[i]);
      }
    }

    // æ¸…é™¤é è¦½èˆ‡æª”æ¡ˆ
    function resetUpload() {
      document.getElementById("photoInput").value = "";
      document.getElementById("uploadInput").value = "";
      document.getElementById("previewArea").innerHTML = "";
      document.getElementById("result").classList.add("d-none");
    }

    // æ¨¡æ“¬é€å‡ºè¾¨è­˜ï¼ˆä½ å¯ä¸²æ¥å¾Œç«¯ APIï¼‰
    function uploadAndRecognize() {
      if (selectedFiles.length === 0) {
        alert("è«‹å…ˆä¸Šå‚³åœ–ç‰‡ï¼");
        return;
      }

      const result = document.getElementById("result");
      result.classList.remove("d-none");

      // æ¨¡æ“¬è¾¨è­˜çµæœï¼ˆæ­£å¼æ‡‰æ”¹ç‚º fetch å‚³åˆ°å¾Œç«¯ï¼‰
      result.innerHTML = selectedFiles.map((f, i) => `ç¬¬ ${i + 1} å¼µï¼šç´…ç‡’ç‰›è‚‰éºµï¼ˆç´„ 580 å¤§å¡ï¼‰`).join("<br>");
    }
  </script>

</body>
</html>
